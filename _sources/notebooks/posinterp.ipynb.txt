{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "cbeab790",
   "metadata": {},
   "source": [
    "# The PositionInterpolator\n",
    "\n",
    "Here we cover the detail of the **PositionInterpolator**. This tool allows you to gather lots of information about what is occurring during an orbit or trigger."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "507770c3",
   "metadata": {},
   "source": [
    "## The Constructor\n",
    "The constructor is build a **PositionInterpolator** from both a Trigdat file and a daily position history file. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "32a5ae99",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-16T13:52:21.156854Z",
     "iopub.status.busy": "2022-03-16T13:52:21.156458Z",
     "iopub.status.idle": "2022-03-16T13:52:25.286132Z",
     "shell.execute_reply": "2022-03-16T13:52:25.285406Z"
    }
   },
   "outputs": [],
   "source": [
    "from gbmgeometry import PositionInterpolator\n",
    "from gbmgeometry.utils.package_utils import get_path_of_data_file\n",
    "\n",
    "trigdat_file = get_path_of_data_file('glg_trigdat_all_bn080916009_v02.fit')\n",
    "\n",
    "pi = PositionInterpolator.from_trigdat(trigdat_file)\n",
    "\n",
    "posthist_file = get_path_of_data_file('glg_poshist_all_151013_v00.fit')\n",
    "\n",
    "pi = PositionInterpolator.from_poshist(posthist_file)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "54cb2c3a",
   "metadata": {},
   "source": [
    "You can even build them from HdF5 file versions of the normal fits files. What? Yes we provide a converter for that as the HDF5 is much smaller and faster to load"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "ea992d74",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-16T13:52:25.290225Z",
     "iopub.status.busy": "2022-03-16T13:52:25.290034Z",
     "iopub.status.idle": "2022-03-16T13:52:25.362864Z",
     "shell.execute_reply": "2022-03-16T13:52:25.362196Z"
    }
   },
   "outputs": [],
   "source": [
    "from gbmgeometry import convert_poshist2hdf5, convert_trigdat2hdf5\n",
    "\n",
    "convert_poshist2hdf5(posthist_file, 'my_posthist.h5')\n",
    "\n",
    "convert_trigdat2hdf5(trigdat_file, 'my_trigdat.h5')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d463f19a",
   "metadata": {},
   "source": [
    "and to load them"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "0c80c50e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-16T13:52:25.366544Z",
     "iopub.status.busy": "2022-03-16T13:52:25.366220Z",
     "iopub.status.idle": "2022-03-16T13:52:25.669385Z",
     "shell.execute_reply": "2022-03-16T13:52:25.668671Z"
    }
   },
   "outputs": [],
   "source": [
    "\n",
    "trigdat_file = get_path_of_data_file('trigdat.h5')\n",
    "\n",
    "pi = PositionInterpolator.from_trigdat_hdf5(trigdat_file)\n",
    "\n",
    "posthist_file = get_path_of_data_file('posthist.h5')\n",
    "\n",
    "pi = PositionInterpolator.from_poshist_hdf5(posthist_file)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "94ed136e",
   "metadata": {},
   "source": [
    "## Plotting\n",
    "We can do some really fun 3D plotting and animation. This is best enjoyed live by [clicking this link](https://mybinder.org/v2/gh/grburgess/gbmgeometry/b206f8a2eaa6ff32259cde006ce863362f073c91).\n",
    "## Basic functions\n",
    "\n",
    "We can check to see if Fermi is active at any time. For example, it is shut off during SAA passage."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "f022c621",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-16T13:52:25.673104Z",
     "iopub.status.busy": "2022-03-16T13:52:25.672761Z",
     "iopub.status.idle": "2022-03-16T13:52:25.690820Z",
     "shell.execute_reply": "2022-03-16T13:52:25.690208Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "tmin, tmax = pi.minmax_time()\n",
    "\n",
    "pi.is_fermi_active(tmin)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "46960798",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-03-16T13:52:25.693804Z",
     "iopub.status.busy": "2022-03-16T13:52:25.693511Z",
     "iopub.status.idle": "2022-03-16T13:52:25.801085Z",
     "shell.execute_reply": "2022-03-16T13:52:25.800570Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7fe2d26b5f70>]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "%matplotlib inline\n",
    "\n",
    "fig, ax = plt.subplots()\n",
    "\n",
    "time = np.linspace(tmin, tmax, 5000)\n",
    "\n",
    "ax.plot(time-tmin,pi.is_fermi_active(time) )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "c839694b",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "jupytext": {
   "formats": "ipynb,md"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.12"
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {
     "04c6fcd743294cdbab6d4e2233769350": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "2.0.0",
      "model_name": "LayoutModel",
      "state": {
       "_model_module": "@jupyter-widgets/base",
       "_model_module_version": "2.0.0",
       "_model_name": "LayoutModel",
       "_view_count": null,
       "_view_module": "@jupyter-widgets/base",
       "_view_module_version": "2.0.0",
       "_view_name": "LayoutView",
       "align_content": null,
       "align_items": null,
       "align_self": null,
       "border_bottom": null,
       "border_left": null,
       "border_right": null,
       "border_top": null,
       "bottom": null,
       "display": null,
       "flex": null,
       "flex_flow": null,
       "grid_area": null,
       "grid_auto_columns": null,
       "grid_auto_flow": null,
       "grid_auto_rows": null,
       "grid_column": null,
       "grid_gap": null,
       "grid_row": null,
       "grid_template_areas": null,
       "grid_template_columns": null,
       "grid_template_rows": null,
       "height": null,
       "justify_content": null,
       "justify_items": null,
       "left": null,
       "margin": null,
       "max_height": null,
       "max_width": null,
       "min_height": null,
       "min_width": null,
       "object_fit": null,
       "object_position": null,
       "order": null,
       "overflow": null,
       "padding": null,
       "right": null,
       "top": null,
       "visibility": null,
       "width": null
      }
     },
     "226c2e10cfbf4645908264b9d4c65707": {
      "model_module": "jupyter-vue",
      "model_module_version": "^1.7.0",
      "model_name": "ForceLoadModel",
      "state": {
       "_dom_classes": [],
       "_model_module": "jupyter-vue",
       "_model_module_version": "^1.7.0",
       "_model_name": "ForceLoadModel",
       "_view_count": null,
       "_view_module": null,
       "_view_module_version": "",
       "_view_name": null,
       "layout": "IPY_MODEL_04c6fcd743294cdbab6d4e2233769350",
       "tabbable": null,
       "tooltip": null
      }
     },
     "47853f8dff8c46da9d036a7de69846a1": {
      "model_module": "jupyter-vuetify",
      "model_module_version": "^1.8.2",
      "model_name": "ThemeModel",
      "state": {
       "_model_module": "jupyter-vuetify",
       "_model_module_version": "^1.8.2",
       "_model_name": "ThemeModel",
       "_view_count": null,
       "_view_module": null,
       "_view_module_version": "^1.8.2",
       "_view_name": null,
       "dark": null
      }
     },
     "6e0f98507982491fad868f227da06e19": {
      "model_module": "jupyter-vuetify",
      "model_module_version": "^1.8.2",
      "model_name": "ThemeColorsModel",
      "state": {
       "_model_module": "jupyter-vuetify",
       "_model_module_version": "^1.8.2",
       "_model_name": "ThemeColorsModel",
       "_theme_name": "dark",
       "_view_count": null,
       "_view_module": null,
       "_view_module_version": "^1.8.2",
       "_view_name": null,
       "accent": "#FF4081",
       "anchor": null,
       "error": "#FF5252",
       "info": "#2196F3",
       "primary": "#2196F3",
       "secondary": "#424242",
       "success": "#4CAF50",
       "warning": "#FB8C00"
      }
     },
     "ae5b97be578d4b7ab996b89f039790ba": {
      "model_module": "jupyter-vuetify",
      "model_module_version": "^1.8.2",
      "model_name": "ThemeColorsModel",
      "state": {
       "_model_module": "jupyter-vuetify",
       "_model_module_version": "^1.8.2",
       "_model_name": "ThemeColorsModel",
       "_theme_name": "light",
       "_view_count": null,
       "_view_module": null,
       "_view_module_version": "^1.8.2",
       "_view_name": null,
       "accent": "#82B1FF",
       "anchor": null,
       "error": "#FF5252",
       "info": "#2196F3",
       "primary": "#1976D2",
       "secondary": "#424242",
       "success": "#4CAF50",
       "warning": "#FB8C00"
      }
     }
    },
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
